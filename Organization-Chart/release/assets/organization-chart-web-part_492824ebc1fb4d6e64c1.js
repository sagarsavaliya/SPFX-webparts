define("6c19e7b7-3425-41fc-b12b-909dd4d83b12_0.0.1",["@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","OrganizationChartWebPartStrings"],(e,t,n,a)=>(()=>{"use strict";var i={967:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a,i,r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};!function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(a||(a={})),function(e){e[e.onlyThemable=1]="onlyThemable",e[e.onlyNonThemable=2]="onlyNonThemable",e[e.all=3]="all"}(i||(i={}));var o,s,c,d="undefined"==typeof window?n.g:window,l=d&&d.CSPSettings&&d.CSPSettings.nonce,u=((c=d.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(c=r(r({},c),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:a.sync,buffer:[]}})),c.registeredThemableStyles||(c=r(r({},c),{registeredThemableStyles:[]})),d.__themeState__=c,c),f=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,p=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function m(e){var t=p();e();var n=p();u.perf.duration+=n-t}function _(e,t){u.loadStyles?u.loadStyles(h(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=h(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),l&&n.setAttribute("nonce",l),n.appendChild(document.createTextNode(i)),u.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var s={styleElement:n,themableStyle:e};r?u.registeredThemableStyles.push(s):u.registeredStyles.push(s)}}(e)}function h(e){var t=u.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}o=".organizationChart_708eb3c8{background:radial-gradient(circle at top,#fafdff 0,#edf2ff 45%,#f6f7fb 100%);display:flex;flex-direction:column;font-family:Inter,Segoe UI,system-ui,-apple-system,BlinkMacSystemFont,sans-serif;height:100vh;width:100%}.organizationChart_708eb3c8.teams_708eb3c8{font-family:Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif}.organizationChart_708eb3c8 *{box-sizing:border-box}.appShell_708eb3c8{display:flex;flex-direction:column;gap:16px;height:100%;padding:24px clamp(20px,4vw,48px)}.topBar_708eb3c8{align-items:center;background:#fff;border-radius:24px;box-shadow:0 12px 30px rgba(15,23,42,.15);display:grid;gap:16px;grid-template-columns:auto minmax(320px,1fr) auto;padding:20px clamp(20px,3vw,36px)}.brand_708eb3c8{align-items:center;display:flex;gap:12px}.brandMark_708eb3c8{background:rgba(49,100,255,.12);border-radius:14px;color:#3164ff;display:grid;font-size:22px;height:46px;place-items:center;width:46px}.brandCopy_708eb3c8{display:flex;flex-direction:column;line-height:1.2}.brandTitle_708eb3c8{font-weight:600}.brandSubtitle_708eb3c8{color:#5f6b7c;font-size:.85rem}.tabBar_708eb3c8{display:flex;flex-wrap:nowrap;gap:8px;justify-content:flex-start;scrollbar-width:none}.tabBar_708eb3c8::-webkit-scrollbar{display:none}.tab_708eb3c8{background:rgba(0,0,0,.04);border:0;border-radius:999px;color:#5f6b7c;cursor:pointer;font-weight:500;padding:10px 18px;transition:background .22s ease,color .22s ease,transform .22s ease,box-shadow .22s ease}.tab_708eb3c8:hover{background:rgba(49,100,255,.12);box-shadow:0 8px 16px rgba(49,100,255,.18);color:#3164ff}.tab_708eb3c8.active{background:#3164ff;box-shadow:0 4px 9px 2px rgba(49,100,255,.4);color:#fff;transform:translateY(-2px)}.searchControls_708eb3c8{display:flex;flex-direction:column;gap:10px}.filters_708eb3c8{display:flex;flex-wrap:wrap;gap:8px}.filterDropdown_708eb3c8{background:#fff;border:1px solid #e1e6ef;border-radius:12px;color:#5f6b7c;cursor:pointer;font-size:.9rem;min-width:150px;padding:8px 12px;transition:border .16s ease,box-shadow .16s ease}.filterDropdown_708eb3c8:focus{border-color:#3164ff;box-shadow:0 4px 12px rgba(49,100,255,.2);outline:0}.filterDropdown_708eb3c8 option{padding:8px}.searchLabel_708eb3c8{color:#5f6b7c;font-size:.78rem;letter-spacing:.08em;text-transform:uppercase}.searchField_708eb3c8{position:relative}.searchField_708eb3c8 input{border:1px solid #e1e6ef;border-radius:16px;font-size:.95rem;padding:11px 46px 11px 16px;transition:border .16s ease,box-shadow .16s ease;width:100%}.searchField_708eb3c8 input:focus{border-color:#3164ff;box-shadow:0 8px 24px rgba(49,100,255,.25);outline:0}.clearSearch_708eb3c8{background:0 0;border:0;border-radius:50%;color:#5f6b7c;cursor:pointer;font-size:.95rem;height:32px;position:absolute;right:6px;top:50%;transform:translateY(-50%);width:32px}.toolbar_708eb3c8{align-items:center;color:#5f6b7c;display:flex;gap:18px;padding:4px 12px 0}.zoomControls_708eb3c8{align-items:center;background:#fff;border:1px solid #e1e6ef;border-radius:999px;box-shadow:0 12px 24px rgba(15,23,42,.12);display:inline-flex;overflow:hidden}.zoomBtn_708eb3c8{background:0 0;border:0;cursor:pointer;font-size:.95rem;padding:9px 16px}.zoomBtn_708eb3c8:hover{background:rgba(49,100,255,.1);color:#3164ff}.hintText_708eb3c8{font-size:.9rem}.chartWrapper_708eb3c8{background:#fff;border-radius:32px;box-shadow:0 12px 30px rgba(15,23,42,.15);display:flex;flex:1;flex-direction:column;min-height:0;overflow:hidden;padding:0}.chartStage_708eb3c8{flex:1;min-height:0;overflow:hidden;position:relative}.orgChartCanvas_708eb3c8{background:radial-gradient(circle at center,hsla(0,0%,100%,.6) 0,hsla(0,0%,100%,0) 40%),#f6f7fb;cursor:grab;display:block;height:100%;width:100%}.orgChartCanvas_708eb3c8:active{cursor:grabbing}.node-wrapper{box-shadow:0 16px 35px rgba(15,23,42,.18)}.node-card,.node-wrapper{border-radius:24px;overflow:visible}.node-card{background:#fff;border-left:6px solid #3164ff;cursor:pointer;display:flex;flex-direction:column;height:120px;padding:10px 15px 10px 10px;transition:transform .2s ease;width:280px}.node-card:hover{transform:translateY(-2px)}.node-card.loading{animation:pulse 1.5s ease-in-out infinite;opacity:.6;pointer-events:none}@keyframes pulse_708eb3c8{0%,to{opacity:.6}50%{opacity:.8}}.node-card .card-header{align-items:center;display:flex;gap:12px}.node-card .persona{border-radius:16px;color:#fff;display:grid;font-weight:600;height:46px;place-items:center;width:46px}.node-card .card-meta{display:flex;flex-direction:column;gap:2px}.node-card .card-meta .name{font-size:1.05rem;font-weight:600}.node-card .card-meta .title{color:#5f6b7c;font-size:.9rem}.node-card .card-meta .department{color:#3164ff;font-size:.85rem}.node-card .card-footer{color:#5f6b7c;display:flex;font-size:.85rem;justify-content:space-between;margin-top:auto}.node-card .card-footer span strong{color:#1f2933;font-weight:600;margin-right:4px}.node-card .chevron{align-items:center;background:#fff;border:2px solid;border-radius:50%;color:#3164ff;display:flex;height:22px;justify-content:center;pointer-events:auto;position:absolute;transition:transform .2s ease;width:22px;z-index:2}.node-card .chevron svg{display:block;flex-shrink:0}.node-card .chevron[data-direction=down]{bottom:6px;left:50%;transform:translate(-50%)}.node-card .chevron[data-direction=right]{right:6px;top:50%;transform:translateY(-50%)}.node-card.collapsed .chevron[data-direction=down]{transform:translate(-50%) scale(.85)}.node-card.collapsed .chevron[data-direction=right]{transform:translateY(-50%) scale(.85)}.node-card.highlight{border-color:#3164ff;box-shadow:0 25px 40px rgba(49,100,255,.35)}path.branch{fill:none;stroke:#c3d4ff;stroke-width:2.8;stroke-linecap:round;transition:d .4s cubic-bezier(.4,0,.2,1),opacity .3s ease}path.branch.active{stroke:#3164ff}@media (max-width:900px){.topBar_708eb3c8{grid-template-columns:1fr}.tabBar_708eb3c8{justify-content:flex-start}}@media (max-width:520px){.brand_708eb3c8{flex-direction:row;justify-content:center}.toolbar_708eb3c8{align-items:flex-start;flex-direction:column}}.profile-modal-overlay{align-items:center;animation:fadeIn .2s ease;background:rgba(0,0,0,.5);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:10000}@keyframes fadeIn_708eb3c8{0%{opacity:0}to{opacity:1}}.profile-modal{animation:slideUp .3s ease;background:#fff;border-radius:24px;box-shadow:0 20px 60px rgba(0,0,0,.3);font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;max-height:90vh;max-width:500px;overflow:auto;width:90%}@keyframes slideUp_708eb3c8{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.profile-modal-header{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:24px 24px 0 0;color:#fff;padding:32px 24px;position:relative;text-align:center}.profile-modal-close{align-items:center;background:hsla(0,0%,100%,.2);border:none;border-radius:50%;color:#fff;cursor:pointer;display:flex;font-size:20px;height:32px;justify-content:center;position:absolute;right:16px;top:16px;transition:background .2s ease;width:32px}.profile-modal-close:hover{background:hsla(0,0%,100%,.3)}.profile-modal-photo{align-items:center;background:hsla(0,0%,100%,.1);border:4px solid hsla(0,0%,100%,.3);border-radius:50%;color:#fff;display:flex;font-size:48px;font-weight:600;height:120px;justify-content:center;margin:0 auto 16px;overflow:hidden;width:120px}.profile-modal-photo img{height:100%;object-fit:cover;width:100%}.profile-modal-name{font-size:24px;font-weight:600;margin:0 0 8px}.profile-modal-title{font-size:16px;margin:0;opacity:.9}.profile-modal-body{padding:24px}.profile-section{margin-bottom:24px}.profile-section:last-child{margin-bottom:0}.profile-section-title{color:#5f6b7c;font-size:12px;font-weight:600;letter-spacing:.08em;margin-bottom:12px;text-transform:uppercase}.profile-info-item{align-items:center;border-bottom:1px solid #f0f0f0;display:flex;gap:12px;padding:10px 0}.profile-info-item:last-child{border-bottom:none}.profile-info-icon{align-items:center;color:#3164ff;display:flex;height:20px;justify-content:center;width:20px}.profile-info-text{color:#1f2933;flex:1;font-size:14px}.profile-info-text a{color:#3164ff;text-decoration:none}.profile-info-text a:hover{text-decoration:underline}.profile-stats{display:grid;gap:16px;grid-template-columns:1fr 1fr}.profile-stat{background:#f6f7fb;border-radius:12px;padding:16px;text-align:center}.profile-stat-value{color:#3164ff;font-size:32px;font-weight:700;margin-bottom:4px}.profile-stat-label{color:#5f6b7c;font-size:12px;letter-spacing:.05em;text-transform:uppercase}@media (max-width:1200px){.topBar_708eb3c8{gap:20px;grid-template-columns:1fr}.brand_708eb3c8{justify-content:center}.tabBar_708eb3c8{justify-content:flex-start;overflow-x:auto;padding-bottom:8px;scrollbar-width:thin}.tabBar_708eb3c8::-webkit-scrollbar{display:block;height:4px}.tabBar_708eb3c8::-webkit-scrollbar-thumb{background:rgba(49,100,255,.3);border-radius:999px}.searchControls_708eb3c8{width:100%}}@media (max-width:768px){.appShell_708eb3c8{gap:12px;padding:16px}.topBar_708eb3c8{border-radius:16px;padding:16px 20px}.brandMark_708eb3c8{font-size:18px;height:38px;width:38px}.brandTitle_708eb3c8{font-size:14px}.brandSubtitle_708eb3c8{font-size:12px}.tab_708eb3c8{font-size:13px;padding:8px 14px;white-space:nowrap}.searchLabel_708eb3c8{font-size:11px}.searchField_708eb3c8 input{font-size:14px;padding:10px 42px 10px 14px}.toolbar_708eb3c8{flex-wrap:wrap;gap:12px}.hintText_708eb3c8{font-size:12px;text-align:center;width:100%}}@media (max-width:480px){.brand_708eb3c8{gap:8px}.brandCopy_708eb3c8{display:none}.tab_708eb3c8{font-size:12px;padding:6px 12px}}",void 0===(s=!0)&&(s=!1),m(function(){var e=Array.isArray(o)?o:function(e){var t=[];if(e){for(var n=0,a=void 0;a=f.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=f.lastIndex}t.push({rawString:e.substring(n)})}return t}(o),t=u.runState,n=t.mode,i=t.buffer,r=t.flushTimer;s||n===a.async?(i.push(e),r||(u.runState.flushTimer=self.setTimeout(function(){u.runState.flushTimer=0,m(function(){var e=u.runState.buffer.slice();u.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&_(t)})},0))):_(e)});const b={organizationChart_708eb3c8:"organizationChart_708eb3c8",teams_708eb3c8:"teams_708eb3c8",appShell_708eb3c8:"appShell_708eb3c8",topBar_708eb3c8:"topBar_708eb3c8",brand_708eb3c8:"brand_708eb3c8",brandMark_708eb3c8:"brandMark_708eb3c8",brandCopy_708eb3c8:"brandCopy_708eb3c8",brandTitle_708eb3c8:"brandTitle_708eb3c8",brandSubtitle_708eb3c8:"brandSubtitle_708eb3c8",tabBar_708eb3c8:"tabBar_708eb3c8",tab_708eb3c8:"tab_708eb3c8",active:"active",searchControls_708eb3c8:"searchControls_708eb3c8",filters_708eb3c8:"filters_708eb3c8",filterDropdown_708eb3c8:"filterDropdown_708eb3c8",searchLabel_708eb3c8:"searchLabel_708eb3c8",searchField_708eb3c8:"searchField_708eb3c8",clearSearch_708eb3c8:"clearSearch_708eb3c8",toolbar_708eb3c8:"toolbar_708eb3c8",zoomControls_708eb3c8:"zoomControls_708eb3c8",zoomBtn_708eb3c8:"zoomBtn_708eb3c8",hintText_708eb3c8:"hintText_708eb3c8",chartWrapper_708eb3c8:"chartWrapper_708eb3c8",chartStage_708eb3c8:"chartStage_708eb3c8",orgChartCanvas_708eb3c8:"orgChartCanvas_708eb3c8","node-wrapper":"node-wrapper","node-card":"node-card",loading:"loading",pulse:"pulse","card-header":"card-header",persona:"persona","card-meta":"card-meta",name:"name",title:"title",department:"department","card-footer":"card-footer",chevron:"chevron",collapsed:"collapsed",highlight:"highlight",branch:"branch","profile-modal-overlay":"profile-modal-overlay",fadeIn:"fadeIn","profile-modal":"profile-modal",slideUp:"slideUp","profile-modal-header":"profile-modal-header","profile-modal-close":"profile-modal-close","profile-modal-photo":"profile-modal-photo","profile-modal-name":"profile-modal-name","profile-modal-title":"profile-modal-title","profile-modal-body":"profile-modal-body","profile-section":"profile-section","profile-section-title":"profile-section-title","profile-info-item":"profile-info-item","profile-info-icon":"profile-info-icon","profile-info-text":"profile-info-text","profile-stats":"profile-stats","profile-stat":"profile-stat","profile-stat-value":"profile-stat-value","profile-stat-label":"profile-stat-label",pulse_708eb3c8:"pulse_708eb3c8",fadeIn_708eb3c8:"fadeIn_708eb3c8",slideUp_708eb3c8:"slideUp_708eb3c8"}}
,676:t=>{t.exports=e},877:e=>{e.exports=t},642:e=>{e.exports=n},478:e=>{e.exports=a}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{default:()=>O});var e=o(676),t=o(877),n=o(642);o(967);const a={organizationChart:"organizationChart_708eb3c8",teams:"teams_708eb3c8",appShell:"appShell_708eb3c8",topBar:"topBar_708eb3c8",brand:"brand_708eb3c8",brandMark:"brandMark_708eb3c8",brandCopy:"brandCopy_708eb3c8",brandTitle:"brandTitle_708eb3c8",brandSubtitle:"brandSubtitle_708eb3c8",tabBar:"tabBar_708eb3c8",tab:"tab_708eb3c8",searchControls:"searchControls_708eb3c8",filters:"filters_708eb3c8",filterDropdown:"filterDropdown_708eb3c8",searchLabel:"searchLabel_708eb3c8",searchField:"searchField_708eb3c8",clearSearch:"clearSearch_708eb3c8",toolbar:"toolbar_708eb3c8",zoomControls:"zoomControls_708eb3c8",zoomBtn:"zoomBtn_708eb3c8",hintText:"hintText_708eb3c8",chartWrapper:"chartWrapper_708eb3c8",chartStage:"chartStage_708eb3c8",orgChartCanvas:"orgChartCanvas_708eb3c8",pulse:"pulse_708eb3c8",fadeIn:"fadeIn_708eb3c8",slideUp:"slideUp_708eb3c8"};var i=o(478),r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},c=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},d=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},l="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xhtml",f=280,p=120,m=.25;function _(e,t,n,a,i,o,s){void 0===a&&(a=1);var _,h,b,g=e.querySelector("#orgChartCanvas"),v=e.querySelectorAll(".".concat(n.tab)),y=e.querySelector("#userSearch"),S=e.querySelector("#clearSearch"),D=e.querySelectorAll(".".concat(n.zoomBtn)),I={data:void 0,deptMap:new Map,activeDept:s||"CCMC",expanded:{},parents:{},matches:new Set,searchTerm:"",zoom:1,pan:{x:0,y:0},bounds:{minX:0,minY:0,maxX:0,maxY:0}},x=new Map,C=new Map,O=new Set,w=!1,E={x:0,y:0},A={x:0,y:0};function L(){if(I.data){var e={},t=function(n,a){void 0!==a&&(e[n.id]=a),(n.children||[]).forEach(function(e){return t(e,n.id)})};I.data.departments.forEach(function(e){e.roots.forEach(function(e){return t(e)})}),I.parents=e}}function k(){var e=I.deptMap.get(I.activeDept);if(e){var t=function(e,n){void 0===n&&(n=0),void 0===I.expanded[e.id]&&(I.expanded[e.id]=n<a),(e.children||[]).forEach(function(e){return t(e,n+1)})};e.roots.forEach(function(e){return t(e)})}}function M(){v.forEach(function(e){var t=e.dataset.dept===I.activeDept;e.className=n.tab,t&&e.classList.add("active"),e.setAttribute("aria-selected",String(t))})}function P(e,t){var n=I.expanded[e];return void 0===n?t<2:n}function T(t){void 0===t&&(t={});var n=I.deptMap.get(I.activeDept);if(n){var a=function(e){var t=[],n=[],a=new Map;if(!e.length)return{nodes:t,edges:n,nodeMap:a,bounds:{minX:0,minY:0,maxX:0,maxY:0}};e.forEach(function(e){return U(e,0)});var i=0;e.forEach(function(e,r){var o=function(e,t){if(void 0===t&&(t=0),x.has(e))return x.get(e);for(var n=["#5B8DEF","#51C6EA","#6DDCD4","#F7B267","#F4845F","#C06C84","#7F5AF0"],a=0,i=0;i<e.length;i+=1)a=e.charCodeAt(i)+((a<<5)-a),a&=a;var r=n[Math.abs(a+t)%n.length];return x.set(e,r),r}(e.id,r),s=F(e,0,i,0,o);t.push.apply(t,s.nodes),n.push.apply(n,s.edges),s.nodes.forEach(function(e){return a.set(e.id,e)}),i+=s.width+200});var r=1/0,o=1/0,s=-1/0,c=-1/0;t.forEach(function(e){r=Math.min(r,e.x),o=Math.min(o,e.y),s=Math.max(s,e.x+f),c=Math.max(c,e.y+p)}),t.length||(r=o=s=c=0);var d=120-r,l=120-o;return t.forEach(function(e){e.x+=d,e.y+=l,a.set(e.id,e)}),{nodes:t,edges:n,nodeMap:a,bounds:{minX:0,minY:0,maxX:s-r+240,maxY:c-o+240}}}(n.roots);I.bounds=a.bounds,function(e,t){for(;h.firstChild;)h.removeChild(h.firstChild);e.forEach(function(e){var n=t.get(e.parent),a=t.get(e.child);if(n&&a){var i=document.createElementNS(l,"path");i.setAttribute("class","branch"),(I.matches.has(n.id)||I.matches.has(a.id))&&i.classList.add("active");var r=function(e,t,n){var a={x:e.x+("down"===n?140:f),y:e.y+("down"===n?p:60)},i={x:t.x+("down"===n?140:0),y:t.y+("down"===n?0:60)};if("down"===n){var r=a.y+.5*(i.y-a.y);return"M ".concat(a.x," ").concat(a.y," C ").concat(a.x," ").concat(r,", ").concat(i.x," ").concat(r,", ").concat(i.x," ").concat(i.y)}var o=a.x+.5*(i.x-a.x);return"M ".concat(a.x," ").concat(a.y," C ").concat(o," ").concat(a.y,", ").concat(o," ").concat(i.y,", ").concat(i.x," ").concat(i.y)}(n,a,e.direction);i.setAttribute("d",r),h.appendChild(i)}})}(a.edges,a.nodeMap),function(t){for(;b.firstChild;)b.removeChild(b.firstChild);t.forEach(function(t){var n=document.createElementNS(l,"foreignObject");n.setAttribute("x",String(t.x)),n.setAttribute("y",String(t.y)),n.setAttribute("width",String(f)),n.setAttribute("height",String(p)),n.setAttribute("class","node-wrapper");var a=document.createElementNS(u,"div");if(a.className="node-card",a.dataset.id=t.id,I.matches.has(t.id)&&a.classList.add("highlight"),!t.isExpanded&&t.hasChildren&&a.classList.add("collapsed"),a.style.borderLeftColor=t.branchColor,a.innerHTML=function(e){var t,n,a,i=V(e.name),r=j(e.id),o=e.photoUrl,s=o?'<img src="'.concat(o,'" alt="').concat(e.name,'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;" onerror="this.style.display=\'none\'; this.parentElement.innerHTML=\'').concat(i,"'; this.parentElement.style.background='").concat(r,"';\" />"):i,c=o?"background: transparent; padding: 0;":"background:".concat(r);return'\n      <div class="card-header">\n        <div class="persona" style="'.concat(c,'">').concat(s,'</div>\n        <div class="card-meta">\n          <span class="name">').concat(e.name,'</span>\n          <span class="title">').concat(e.title,'</span>\n          <span class="department">').concat(e.department,'</span>\n        </div>\n      </div>\n      <div class="card-footer">\n        <span><strong>').concat(null!==(t=e.reportingCount)&&void 0!==t?t:0,"</strong> Reports</span>\n        <span><strong>").concat(null!==(n=e.directCount)&&void 0!==n?n:(null===(a=e.children)||void 0===a?void 0:a.length)||0,"</strong> Direct</span>\n      </div>\n    ")}(t),n.appendChild(a),b.appendChild(n),t.hasChildren){var r=document.createElementNS(u,"div");r.className="chevron";var o=0===t.depth?"down":"right";r.dataset.direction=o;var s="down"===o?'<svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M8 11.414l-6.707-6.707 1.414-1.414L8 8.586l5.293-5.293 1.414 1.414L8 11.414z"/></svg>':'<svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M11.414 8l-6.707 6.707-1.414-1.414L8.586 8 3.293 2.707l1.414-1.414L11.414 8z"/></svg>';r.innerHTML=s,a.appendChild(r),r.addEventListener("click",function(n){n.stopPropagation(),function(t){c(this,void 0,void 0,function(){var n,a,r,o,s,c;return d(this,function(d){switch(d.label){case 0:if(n=I.expanded[t],!(a=!n)||!i)return[3,5];if(r=function(e){if(I.data)for(var t=0,n=I.data.departments;t<n.length;t++)for(var a=0,i=n[t].roots;a<i.length;a++){var r=o(i[a]);if(r)return r}function o(t){if(t.id===e)return t;if(t.children)for(var n=0,a=t.children;n<a.length;n++){var i=o(a[n]);if(i)return i}}}(t),!r||r.children&&0!==r.children.length||!((r.directCount||0)>0))return[3,5];if(O.has(t))return[2];O.add(t),d.label=1;case 1:return d.trys.push([1,3,4,5]),(o=e.querySelector('[data-id="'.concat(t,'"]')))&&o.classList.add("loading"),[4,i(t)];case 2:return s=d.sent(),r&&s.length>0&&(r.children=s,L()),o&&o.classList.remove("loading"),[3,5];case 3:return c=d.sent(),console.error("Error loading children for node ".concat(t,":"),c),[3,5];case 4:return O.delete(t),[7];case 5:return I.expanded[t]=a,T(),[2]}})})}(t.id)})}a.addEventListener("click",function(e){e.stopPropagation(),function(e){var t,n,a,i=V(e.name),r=j(e.id),o=e.photoUrl,s=o?'<img src="'.concat(o,'" alt="').concat(e.name,'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;" onerror="this.style.display=\'none\'; this.parentElement.innerHTML=\'').concat(i,"'; this.parentElement.style.background='").concat(r,"'; this.parentElement.style.display='flex'; this.parentElement.style.alignItems='center'; this.parentElement.style.justifyContent='center'; this.parentElement.style.fontSize='48px'; this.parentElement.style.fontWeight='600'; this.parentElement.style.color='white';\" />"):i,c=o?"background: transparent; padding: 0;":"background:".concat(r,"; display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: 600; color: white;"),d='\n      <div class="profile-modal-overlay" id="profileModalOverlay">\n        <div class="profile-modal">\n          <div class="profile-modal-header">\n            <button class="profile-modal-close" id="profileModalClose">√ó</button>\n            <div class="profile-modal-photo" style="'.concat(c,'">\n              ').concat(s,'\n            </div>\n            <h2 class="profile-modal-name">').concat(e.name,'</h2>\n            <p class="profile-modal-title">').concat(e.title,'</p>\n          </div>\n          <div class="profile-modal-body">\n            <div class="profile-section">\n              <div class="profile-section-title">Contact Information</div>\n              <div class="profile-info-item">\n                <div class="profile-info-icon">‚úâ</div>\n                <div class="profile-info-text">\n                  <a href="mailto:').concat(e.name.toLowerCase().replace(" ","."),'@company.com">\n                    ').concat(e.name.toLowerCase().replace(" ","."),'@company.com\n                  </a>\n                </div>\n              </div>\n              <div class="profile-info-item">\n                <div class="profile-info-icon">üì±</div>\n                <div class="profile-info-text">+1 (555) 123-4567</div>\n              </div>\n            </div>\n            <div class="profile-section">\n              <div class="profile-section-title">Organization</div>\n              <div class="profile-info-item">\n                <div class="profile-info-icon">üè¢</div>\n                <div class="profile-info-text">').concat(e.department,'</div>\n              </div>\n              <div class="profile-info-item">\n                <div class="profile-info-icon">üíº</div>\n                <div class="profile-info-text">').concat(e.title,'</div>\n              </div>\n              <div class="profile-info-item">\n                <div class="profile-info-icon">üìç</div>\n                <div class="profile-info-text">Main Office</div>\n              </div>\n            </div>\n            <div class="profile-section">\n              <div class="profile-section-title">Team</div>\n              <div class="profile-stats">\n                <div class="profile-stat">\n                  <div class="profile-stat-value">').concat(null!==(t=e.reportingCount)&&void 0!==t?t:0,'</div>\n                  <div class="profile-stat-label">Total Reports</div>\n                </div>\n                <div class="profile-stat">\n                  <div class="profile-stat-value">').concat(null!==(n=e.directCount)&&void 0!==n?n:(null===(a=e.children)||void 0===a?void 0:a.length)||0,'</div>\n                  <div class="profile-stat-label">Direct Reports</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    '),l=document.createElement("div");l.innerHTML=d,document.body.appendChild(l);var u=function(){l.remove()},f=document.getElementById("profileModalClose"),p=document.getElementById("profileModalOverlay");f&&f.addEventListener("click",u),p&&p.addEventListener("click",function(e){e.target===p&&u()}),document.addEventListener("keydown",function e(t){"Escape"===t.key&&(u(),document.removeEventListener("keydown",e))})}(t)})})}(a.nodes),t.center?N():B()}}function U(e,t){var n=e.children||[];if(!P(e.id,t)||0===n.length)return e._dimensions={width:f,height:p,childrenHeight:0},e._dimensions;var a=n.map(function(e){return U(e,t+1)});if(0===t){var i=a.reduce(function(e,t,n){return e+t.height+(n<a.length-1?60:0)},0),r=Math.max.apply(Math,function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([f],a.map(function(e){return e.width}),!1));e._dimensions={width:r,height:180+i,childrenHeight:i}}else{i=a.reduce(function(e,n,i){return e+n.height+(i<a.length-1?H(t+1):0)},0);var o=460+(r=Math.max.apply(Math,a.map(function(e){return e.width})));e._dimensions={width:o,height:Math.max(p,i),childrenHeight:i}}return e._dimensions}function F(e,t,n,a,i){var o,s=[],c=[],d=e.children||[],l=P(e.id,t),u=e._dimensions||{width:f,height:p},m=r(r({},e),{depth:t,x:n,y:a,branchColor:i,hasChildren:d.length>0||(null!==(o=e.directCount)&&void 0!==o?o:0)>0,isExpanded:l,orientation:0===t?"down":"right"});if(s.push(m),!d.length||!l)return{nodes:s,edges:c,width:f,height:p};if(0===t){var _=a+p+60;return d.forEach(function(a,r){var o=F(a,t+1,n,_,i);s.push.apply(s,o.nodes),c.push({parent:e.id,child:a.id,direction:"down"}),c.push.apply(c,o.edges),_+=o.height,r<d.length-1&&(_+=60)}),{nodes:s,edges:c,width:u.width,height:u.height}}var h=n+f+180,b=H(t+1),g=d.reduce(function(e,t,n){return e+(t._dimensions||{height:p}).height+(n<d.length-1?b:0)},0),v=a;return d.forEach(function(n,a){var r=F(n,t+1,h,v,i);s.push.apply(s,r.nodes),c.push({parent:e.id,child:n.id,direction:"right"}),c.push.apply(c,r.edges),v+=r.height,a<d.length-1&&(v+=b)}),{nodes:s,edges:c,width:u.width,height:Math.max(p,g)}}function H(e){return 1===e?60:2===e?50:3===e?45:Math.max(40,60-5*e)}function R(e,t){var n=e/I.zoom;I.pan.x=t.x-(t.x-I.pan.x)*n,I.pan.y=t.y-(t.y-I.pan.y)*n,I.zoom=e,B()}function N(){var e=I.bounds,t=g.getBoundingClientRect(),n=e.maxX-e.minX,a=e.maxY-e.minY,i=.8*t.width/n,r=.8*t.height/a,o=Math.min(i,r);I.zoom=z(o,m,2.8);var s=e.minX+n/2,c=e.minY+a/2;I.pan.x=t.width/2-s*I.zoom,I.pan.y=t.height/2-c*I.zoom,B()}function B(){_.setAttribute("transform","translate(".concat(I.pan.x,", ").concat(I.pan.y,") scale(").concat(I.zoom,")"));var t=e.querySelector('[data-zoom="reset"]');t&&(t.textContent="".concat(Math.round(100*I.zoom),"%"))}function j(e){if(C.has(e))return C.get(e);var t=Math.abs(function(e){for(var t=0,n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}(e))%360,n="hsl(".concat(t,", 65%, 45%)");return C.set(e,n),n}function V(e){return e.split(" ").map(function(e){return e[0]}).join("").slice(0,2).toUpperCase()}function z(e,t,n){return Math.min(Math.max(e,t),n)}_=document.createElementNS(l,"g"),h=document.createElementNS(l,"g"),b=document.createElementNS(l,"g"),_.appendChild(h),_.appendChild(b),g.appendChild(_),v.forEach(function(e){e.addEventListener("click",function(){!function(e){c(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return I.deptMap.has(e)?[3,3]:(console.log("Department ".concat(e," not found in map, attempting to load...")),o?[4,o(e)]:[3,2]);case 1:return t.sent(),[2];case 2:return console.warn("No tab switch handler available to load ".concat(e)),[2];case 3:return I.activeDept=e,k(),M(),T({center:!0}),[2]}})})}(e.dataset.dept)})}),y.addEventListener("input",function(e){return t=e.target.value,I.searchTerm=t.trim().toLowerCase(),I.matches=function(){if(!I.searchTerm)return new Set;var e=new Set,t=I.deptMap.get(I.activeDept);if(!t)return e;var n=function(t){-1!=="".concat(t.name," ").concat(t.title," ").concat(t.department).toLowerCase().indexOf(I.searchTerm)&&e.add(t.id),(t.children||[]).forEach(n)};return t.roots.forEach(n),e}(),I.searchTerm.length&&I.matches.forEach(function(e){return function(e){for(var t=e;t;)I.expanded[t]=!0,t=I.parents[t]}(e)}),T(),void(S.hidden=!I.searchTerm.length);var t}),S.addEventListener("click",function(){return I.searchTerm="",I.matches.clear(),y.value="",S.hidden=!0,void T()}),D.forEach(function(e){e.addEventListener("click",function(){return function(e){if("reset"===e)return I.zoom=1,void N();var t="in"===e?.12:-.12,n=z(I.zoom+t,m,2.8),a=g.getBoundingClientRect();R(n,{x:a.width/2,y:a.height/2})}(e.dataset.zoom)})}),g.addEventListener("wheel",function(e){return function(e){e.preventDefault();var t=e.deltaY<0?.12:-.12,n=z(I.zoom+t,m,2.8),a=g.getBoundingClientRect();R(n,{x:e.clientX-a.left,y:e.clientY-a.top})}(e)},{passive:!1}),g.addEventListener("pointerdown",function(e){return function(e){0===e.button&&(e.target&&"function"==typeof e.target.closest&&e.target.closest(".node-card")||(w=!0,E=r({},I.pan),A={x:e.clientX,y:e.clientY},g.setPointerCapture(e.pointerId)))}(e)}),window.addEventListener("pointerup",function(e){return function(e){w&&(w=!1,g.releasePointerCapture(e.pointerId))}(e)}),window.addEventListener("pointermove",function(e){return function(e){if(w){var t=e.clientX-A.x,n=e.clientY-A.y;I.pan.x=E.x+t,I.pan.y=E.y+n,B()}}(e)}),window.addEventListener("resize",function(){return N()}),S&&(S.hidden=!0),function(){c(this,void 0,void 0,function(){return d(this,function(e){try{console.log("=== orgChartLogic init() START ==="),I.data=t,t&&t.departments?(console.log("Processing departments:",t.departments.map(function(e){return e.name})),console.log("Active department:",I.activeDept),t.departments.forEach(function(e){I.deptMap.set(e.name,e)}),console.log("Department map size:",I.deptMap.size),console.log("Has active dept in map?",I.deptMap.has(I.activeDept)),L(),k(),M(),T({center:!0}),console.log("=== orgChartLogic init() END ===")):console.error("No data provided to org chart")}catch(e){console.error("Failed to load hierarchy",e)}return[2]})})}()}var h,b=function(){return b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},g=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},v=function(){function e(e,n){this.type=t.PropertyPaneFieldType.Custom,this.targetProperty=e,this.properties=b(b({},n),{key:"TabsPropertyPane_".concat(e),onRender:this.onRender.bind(this),onDispose:this.onDispose.bind(this)})}return e.prototype.onRender=function(e){this.elem=e,this.render()},e.prototype.onDispose=function(e){e.innerHTML=""},e.prototype.render=function(){this.elem&&this.renderContent(this.elem)},e.prototype.renderContent=function(e){var t=this;e.innerHTML="";var n=document.createElement("div");n.style.marginTop="10px";var a=document.createElement("div");a.style.marginBottom="10px",a.style.fontWeight="600",a.textContent="Manage Tabs",n.appendChild(a),this.properties.tabs.forEach(function(e,a){var i=t.createTabCard(e,a);n.appendChild(i)});var i=document.createElement("button");i.textContent="+ Add New Tab",i.style.padding="8px 16px",i.style.backgroundColor="#0078d4",i.style.color="white",i.style.border="none",i.style.borderRadius="2px",i.style.cursor="pointer",i.style.fontSize="14px",i.style.marginTop="8px",i.onclick=function(){return t.handleAddTab()},n.appendChild(i),e.appendChild(n)},e.prototype.createTabCard=function(e,t){var n=this,a=document.createElement("div");a.style.border="1px solid #edebe9",a.style.padding="12px",a.style.marginBottom="8px",a.style.borderRadius="2px",a.style.backgroundColor="#faf9f8";var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px",i.style.marginBottom="8px";var r=document.createElement("div");r.style.flex="1";var o=document.createElement("label");o.style.display="block",o.style.fontSize="12px",o.style.marginBottom="4px",o.textContent="Tab Name",r.appendChild(o);var s=document.createElement("input");s.type="text",s.value=e.name,s.style.width="-webkit-fill-available",s.style.padding="6px 8px",s.style.fontSize="14px",s.style.border="1px solid #8a8886",s.style.borderRadius="2px",s.onchange=function(){return n.handleTabNameChange(t,s.value)},r.appendChild(s),i.appendChild(r);var c=document.createElement("div");c.style.display="flex",c.style.gap="4px",c.style.marginTop="18px";var d=document.createElement("button");d.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M6.5 1h3a.5.5 0 0 1 .5.5v1h4a.5.5 0 0 1 0 1h-.441l-.443 10.5a1 1 0 0 1-1 .95h-8.23a1 1 0 0 1-1-.95L2.44 3.5H2a.5.5 0 0 1 0-1h4v-1a.5.5 0 0 1 .5-.5zM3.45 3.5l.429 10.5h8.24l.43-10.5H3.45zM6.5 5.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5z"/></svg>',d.title="Delete",d.style.padding="6px",d.style.backgroundColor="transparent",d.style.color="#a4262c",d.style.border="1px solid #8a8886",d.style.borderRadius="2px",d.style.cursor="pointer",d.style.display="flex",d.style.alignItems="center",d.style.justifyContent="center",d.style.width="32px",d.style.height="32px",d.onmouseover=function(){d.style.backgroundColor="#fef0f1",d.style.borderColor="#a4262c"},d.onmouseout=function(){d.style.backgroundColor="transparent",d.style.borderColor="#8a8886"},d.onclick=function(){return n.handleDeleteTab(t)},c.appendChild(d),i.appendChild(c),a.appendChild(i);var l=document.createElement("label");l.style.display="block",l.style.fontSize="12px",l.style.marginBottom="4px",l.textContent="Top Person Email",a.appendChild(l);var u=document.createElement("input");return u.type="email",u.value=e.topPersonEmail,u.placeholder="user@ccmcnet.com",u.style.width="-webkit-fill-available",u.style.padding="6px 8px",u.style.fontSize="14px",u.style.border="1px solid #8a8886",u.style.borderRadius="2px",u.onchange=function(){return n.handleTopPersonChange(t,u.value)},a.appendChild(u),a},e.prototype.handleTabNameChange=function(e,t){var n=g([],this.properties.tabs,!0);n[e]=b(b({},n[e]),{name:t}),this.updateTabs(n)},e.prototype.handleTopPersonChange=function(e,t){var n=g([],this.properties.tabs,!0);n[e]=b(b({},n[e]),{topPersonEmail:t}),this.updateTabs(n)},e.prototype.handleDeleteTab=function(e){if(confirm('Are you sure you want to delete the tab "'.concat(this.properties.tabs[e].name,'"?'))){var t=this.properties.tabs.filter(function(t,n){return n!==e});this.updateTabs(t)}},e.prototype.handleAddTab=function(){var e={id:"tab_".concat(Date.now()),name:"New Tab",topPersonEmail:""},t=g(g([],this.properties.tabs,!0),[e],!1);this.updateTabs(t)},e.prototype.updateTabs=function(e){this.properties.tabs=e,this.properties.onTabsChange(e),this.render()},e}(),y=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},S=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},D=function(){function e(e){this.userCache=new Map,this.photoCache=new Map,this.subordinatesCountCache=new Map,this.context=e}return e.prototype.init=function(){return y(this,void 0,void 0,function(){var e,t;return S(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),console.log("GraphService: Requesting MS Graph Client v3..."),e=this,[4,this.context.msGraphClientFactory.getClient("3")];case 1:return e.graphClient=n.sent(),console.log("GraphService: MS Graph Client obtained successfully"),[3,3];case 2:throw t=n.sent(),console.error("GraphService: Failed to get MS Graph Client:",t),new Error("Failed to initialize Graph client: ".concat(t instanceof Error?t.message:"Unknown error"));case 3:return[2]}})})},e.prototype.getCurrentUser=function(){return y(this,void 0,void 0,function(){return S(this,function(e){switch(e.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");return[4,this.graphClient.api("/me").select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").get()];case 1:return[2,e.sent()]}})})},e.prototype.getUserById=function(e){return y(this,void 0,void 0,function(){var t;return S(this,function(n){switch(n.label){case 0:if(this.userCache.has(e))return[2,this.userCache.get(e)];if(!this.graphClient)throw new Error("Graph client not initialized");return[4,this.graphClient.api("/users/".concat(e)).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").get()];case 1:return t=n.sent(),this.userCache.set(e,t),[2,t]}})})},e.prototype.getUserPhoto=function(e){return y(this,void 0,void 0,function(){var t,n;return S(this,function(a){switch(a.label){case 0:if(this.photoCache.has(e))return[2,this.photoCache.get(e)];if(!this.graphClient)throw new Error("Graph client not initialized");a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.graphClient.api("/users/".concat(e,"/photo/$value")).get()];case 2:return t=a.sent(),n=URL.createObjectURL(t),this.photoCache.set(e,n),[2,n];case 3:return a.sent(),console.warn("Could not fetch photo for user ".concat(e)),[2,void 0];case 4:return[2]}})})},e.prototype.getDirectReports=function(e){return y(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");return[4,this.graphClient.api("/users/".concat(e,"/directReports")).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").get()];case 1:return[2,t.sent().value||[]]}})})},e.prototype.getManager=function(e){return y(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.graphClient.api("/users/".concat(e,"/manager")).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").get()];case 2:return[2,t.sent()];case 3:return t.sent(),console.warn("No manager found for user ".concat(e)),[2,void 0];case 4:return[2]}})})},e.prototype.buildOrgHierarchy=function(e,t,n){return void 0===t&&(t=5),void 0===n&&(n=0),y(this,void 0,void 0,function(){var a,i,r,o=this;return S(this,function(s){switch(s.label){case 0:return[4,this.getUserById(e)];case 1:return a=s.sent(),n>=t?[2,a]:[4,this.getDirectReports(e)];case 2:return(i=s.sent()).length>0?(r=a,[4,Promise.all(i.map(function(e){return o.buildOrgHierarchy(e.id,t,n+1)}))]):[3,4];case 3:r.directReports=s.sent(),s.label=4;case 4:return[2,a]}})})},e.prototype.searchUsers=function(e){return y(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");return[4,this.graphClient.api("/users").filter("startsWith(displayName,'".concat(e,"') or startsWith(mail,'").concat(e,"')")).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").top(20).get()];case 1:return[2,t.sent().value||[]]}})})},e.prototype.getUserByEmail=function(e){return y(this,void 0,void 0,function(){var t,n,a;return S(this,function(i){switch(i.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");i.label=1;case 1:i.trys.push([1,7,,8]),i.label=2;case 2:return i.trys.push([2,4,,6]),[4,this.graphClient.api("/users/".concat(encodeURIComponent(e))).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").get()];case 3:return[2,i.sent()];case 4:return t=i.sent(),[4,this.graphClient.api("/users").filter("mail eq '".concat(e.replace(/'/g,"''"),"' or userPrincipalName eq '").concat(e.replace(/'/g,"''"),"'")).select("id,displayName,jobTitle,department,mail,mobilePhone,businessPhones,officeLocation").top(1).get()];case 5:if((n=i.sent()).value&&n.value.length>0)return[2,n.value[0]];throw t;case 6:return[3,8];case 7:return a=i.sent(),console.warn("User not found with email: ".concat(e),a),[2,void 0];case 8:return[2]}})})},e.prototype.getAllUsers=function(){return y(this,void 0,void 0,function(){return S(this,function(e){switch(e.label){case 0:if(!this.graphClient)throw new Error("Graph client not initialized");return[4,this.graphClient.api("/users").select("id,displayName,jobTitle,department,officeLocation").top(999).get()];case 1:return[2,e.sent().value||[]]}})})},e.prototype.getTotalSubordinatesCount=function(e){return y(this,void 0,void 0,function(){var t,n,a,i,r=this;return S(this,function(o){switch(o.label){case 0:if(this.subordinatesCountCache.has(e))return[2,this.subordinatesCountCache.get(e)];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.getDirectReports(e)];case 2:return 0===(t=o.sent()).length?(this.subordinatesCountCache.set(e,0),[2,0]):(n=t.length,[4,Promise.all(t.map(function(e){return r.getTotalSubordinatesCount(e.id)}))]);case 3:return a=o.sent(),n+=a.reduce(function(e,t){return e+t},0),this.subordinatesCountCache.set(e,n),[2,n];case 4:return i=o.sent(),console.error("Error getting subordinates count for user ".concat(e,":"),i),[2,0];case 5:return[2]}})})},e}(),I=(h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},h(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),x=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},C=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const O=function(n){function r(){var e=null!==n&&n.apply(this,arguments)||this;return e.orgData=null,e.graphReadyPromise=null,e.isLoadingData=!1,e.currentActiveDept="CCMC",e}return I(r,n),r.prototype.render=function(){var e,t;return x(this,void 0,void 0,function(){var n,i,r=this;return C(this,function(o){return console.log("=== render() called ===",{hasOrgData:!!this.orgData,departmentCount:(null===(t=null===(e=this.orgData)||void 0===e?void 0:e.departments)||void 0===t?void 0:t.length)||0,currentActiveDept:this.currentActiveDept,isLoadingData:this.isLoadingData}),n=(this.properties.tabs||[]).map(function(e,t){return'<button class="'.concat(a.tab,'" role="tab" aria-selected="').concat(0===t?"true":"false",'" data-dept="').concat(e.name,'" data-tab-id="').concat(e.id,'">').concat(e.name,"</button>")}).join(""),this.domElement.innerHTML='\n    <section class="'.concat(a.organizationChart," ").concat(this.context.sdks.microsoftTeams?a.teams:"",'">\n      <div class="').concat(a.appShell,'">\n        <header class="').concat(a.topBar,'">\n          <div class="').concat(a.brand,'">\n            <span class="').concat(a.brandMark,'">‚óé</span>\n            <div class="').concat(a.brandCopy,'">\n              <span class="').concat(a.brandTitle,'">Org Navigator</span>\n              <span class="').concat(a.brandSubtitle,'">Enterprise Hierarchy</span>\n            </div>\n          </div>\n\n          <nav class="').concat(a.tabBar,'" role="tablist" aria-label="Departments">\n            ').concat(n,'\n          </nav>\n\n          <div class="').concat(a.searchControls,'">\n            <div class="').concat(a.searchField,'">\n              <input id="userSearch" type="search" placeholder="Search by name, title, or department" autocomplete="off" spellcheck="false">\n              <button id="clearSearch" type="button" class="').concat(a.clearSearch,'" aria-label="Clear search">‚úï</button>\n            </div>\n          </div>\n        </header>\n\n        <section class="').concat(a.toolbar,'" aria-label="Chart controls">\n          <div class="').concat(a.zoomControls,'">\n            <button type="button" class="').concat(a.zoomBtn,'" data-zoom="out" aria-label="Zoom out">‚àí</button>\n            <button type="button" class="').concat(a.zoomBtn,'" data-zoom="reset" aria-label="Reset zoom">100%</button>\n            <button type="button" class="').concat(a.zoomBtn,'" data-zoom="in" aria-label="Zoom in">+</button>\n          </div>\n          <div class="').concat(a.hintText,'">Drag anywhere on the canvas to pan. Scroll to zoom.</div>\n        </section>\n\n        <section class="').concat(a.chartWrapper,'">\n          <div class="').concat(a.chartStage,'">\n            <svg id="orgChartCanvas" class="').concat(a.orgChartCanvas,'" role="group" aria-label="Organization chart"></svg>\n          </div>\n        </section>\n      </div>\n    </section>'),this.orgData?(console.log("Initializing chart with data:",{departments:this.orgData.departments.map(function(e){return e.name}),activeDept:this.currentActiveDept}),_(this.domElement,this.orgData,a,1,function(e){return r.loadNodeChildren(e)},function(e){return r.handleTabSwitch(e)},this.currentActiveDept)):(console.log("No org data yet, showing loading message"),(i=this.domElement.querySelector(".".concat(a.chartWrapper)))&&(i.innerHTML='<div style="padding: 40px; text-align: center;">Loading CCMC hierarchy...</div>'),this.isLoadingData||(console.log("Triggering initial data load from render()..."),this.loadInitialData().catch(function(e){console.error("Error in loadInitialData:",e)}))),[2]})})},r.prototype.loadInitialData=function(){return x(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:if(this.isLoadingData||this.orgData)return console.log("Skipping loadInitialData - already loading or have data"),[2];t.label=1;case 1:return t.trys.push([1,5,,6]),console.log("Starting initial data load..."),this.graphReadyPromise?[4,this.graphReadyPromise]:[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.loadOrgData(this.currentActiveDept)];case 4:return t.sent(),[3,6];case 5:return e=t.sent(),console.error("Error loading organization data:",e),this.showError("Error loading organization data. Please check the configuration and console for details."),[3,6];case 6:return[2]}})})},r.prototype.onInit=function(){var e;return x(this,void 0,void 0,function(){var t,n;return C(this,function(a){switch(a.label){case 0:console.log("=== onInit START ==="),this.properties.tabs&&0!==this.properties.tabs.length||(this.properties.tabs=[{id:"tab_1",name:"CCMC",topPersonEmail:"df87625@ccmcnet.com"},{id:"tab_2",name:"CMH",topPersonEmail:"ddulsky@ccmcnet.com"},{id:"tab_3",name:"Community Financial Services",topPersonEmail:"as58741@ccmcnet.com"},{id:"tab_4",name:"Corporate Finance & Legal",topPersonEmail:"sm23873@ccmcnet.com"},{id:"tab_5",name:"HR",topPersonEmail:"U3E012231@ccmcnet.com"},{id:"tab_6",name:"IT",topPersonEmail:"bbustos@ccmcnet.com"}]),this.properties.tabs&&this.properties.tabs.length>0&&(t=null!==(e=this.properties.tabs.find(function(e){var t;return"ccmc"===(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())}))&&void 0!==e?e:this.properties.tabs[0],this.currentActiveDept=t.name,console.log("Initial active department set to: ".concat(this.currentActiveDept))),this.properties.dataSource||(this.properties.dataSource="azureAD"),a.label=1;case 1:return a.trys.push([1,3,,4]),console.log("Initializing GraphService..."),this.graphService=new D(this.context),this.graphReadyPromise=this.graphService.init(),[4,this.graphReadyPromise];case 2:return a.sent(),console.log("GraphService initialized successfully"),[3,4];case 3:throw n=a.sent(),console.error("Failed to initialize GraphService:",n),n;case 4:return console.log("=== onInit END ==="),[2]}})})},r.prototype.onAfterRender=function(){var e=this;console.log("onAfterRender called",{hasOrgData:!!this.orgData,isLoadingData:this.isLoadingData,currentActiveDept:this.currentActiveDept}),this.orgData||this.isLoadingData?console.log("Skipping data load - already have data or loading in progress"):setTimeout(function(){x(e,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),console.log("Starting initial data load..."),this.graphReadyPromise?[4,this.graphReadyPromise]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,this.loadOrgData(this.currentActiveDept)];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),console.error("Error loading organization data:",e),this.showError("Error loading organization data. Please check the configuration and console for details."),[3,5];case 5:return[2]}})})},100)},r.prototype.showError=function(e){var t=document.createElement("div");t.style.cssText="padding: 40px; text-align: center; color: red;",t.textContent=e;var n=this.domElement.querySelector(".".concat(a.chartWrapper));n&&(n.innerHTML="",n.appendChild(t))},r.prototype.loadOrgData=function(e){var t,n;return x(this,void 0,void 0,function(){var a,i,r,o,s,c,d,l,u;return C(this,function(f){switch(f.label){case 0:if(this.isLoadingData)return console.log("Already loading data, skipping..."),[2];this.isLoadingData=!0,console.log("=== loadOrgData START ==="),console.log("Loading hierarchy for tab: ".concat(e||"default (CCMC)","...")),f.label=1;case 1:return f.trys.push([1,5,6,7]),this.graphService?(a=this.properties.tabs&&this.properties.tabs.length>0?this.properties.tabs:[{id:"tab_1",name:"CCMC",topPersonEmail:"df87625@ccmcnet.com"}],(i=e?a.find(function(t){return t.name===e}):null!==(t=a.find(function(e){var t;return"ccmc"===(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())}))&&void 0!==t?t:a.find(function(e){return!!e.topPersonEmail}))&&i.topPersonEmail?(r=i,console.log("Loading ".concat(r.name," data for ").concat(r.topPersonEmail)),[4,this.graphService.getUserByEmail(r.topPersonEmail)]):(this.showError("".concat(e||"Default"," tab is not configured with a top person email.")),[2])):(console.error("GraphService not initialized"),this.showError("GraphService not initialized. Please refresh the page."),[2]);case 2:return(o=f.sent())?(console.log("Building hierarchy for ".concat(o.displayName," (root + 1 level)")),[4,this.graphService.buildOrgHierarchy(o.id,2)]):(this.showError("Unable to find the user ".concat(r.topPersonEmail," in Azure AD.")),[2]);case 3:return s=f.sent(),console.log("Hierarchy built. Transforming to org node..."),[4,this.transformGraphUserToOrgNodeWithCounts(s)];case 4:return c=f.sent(),console.log("Org node transformed. Root: ".concat(c.name,", Direct reports: ").concat(c.directCount)),this.orgData||(this.orgData={departments:[]}),d=this.orgData.departments.findIndex(function(e){return e.name===r.name}),l={id:r.id,name:r.name,roots:[c]},d>=0?this.orgData.departments[d]=l:this.orgData.departments.push(l),console.log("".concat(r.name," data loaded successfully:"),{department:r.name,rootName:c.name,rootId:c.id,directReports:c.directCount,childrenLoaded:(null===(n=c.children)||void 0===n?void 0:n.length)||0,totalDepartments:this.orgData.departments.length}),console.log("=== loadOrgData END - Calling render() ==="),this.render(),[3,7];case 5:return u=f.sent(),console.error("Error loading organization data:",u),this.showError("Error loading organization data: ".concat(u instanceof Error?u.message:"Unknown error",". Please check the console for details.")),[3,7];case 6:return this.isLoadingData=!1,[7];case 7:return[2]}})})},r.prototype.handleTabSwitch=function(e){return x(this,void 0,void 0,function(){var t;return C(this,function(n){switch(n.label){case 0:return console.log("Tab switch requested: ".concat(e)),this.currentActiveDept=e,this.orgData&&this.orgData.departments.some(function(t){return t.name===e})?(console.log("".concat(e," data already loaded, switching to it")),this.render(),[2]):((t=this.domElement.querySelector(".".concat(a.chartWrapper)))&&(t.innerHTML='<div style="padding: 40px; text-align: center;">Loading '.concat(e," hierarchy...</div>")),[4,this.loadOrgData(e)]);case 1:return n.sent(),[2]}})})},r.prototype.transformGraphUserToOrgNodeWithCounts=function(e){return x(this,void 0,void 0,function(){var t,n,a,i,r,o=this;return C(this,function(s){switch(s.label){case 0:return[4,this.graphService.getUserPhoto(e.id)];case 1:return t=s.sent(),n=e.directReports||[],a=n.length,[4,this.graphService.getTotalSubordinatesCount(e.id)];case 2:return i=s.sent(),[4,Promise.all(n.map(function(e){return x(o,void 0,void 0,function(){var t;return C(this,function(n){switch(n.label){case 0:return[4,this.graphService.getDirectReports(e.id)];case 1:return t=n.sent(),[2,{id:e.id,name:e.displayName,title:e.jobTitle||"No Title",department:e.department||"No Department",photoUrl:void 0,directCount:t.length,reportingCount:t.length,children:void 0}]}})})}))];case 3:return r=s.sent(),[2,{id:e.id,name:e.displayName,title:e.jobTitle||"No Title",department:e.department||"No Department",photoUrl:t,children:r.length>0?r:void 0,directCount:a,reportingCount:i}]}})})},r.prototype.transformGraphUserToOrgNodeAsync=function(e){return x(this,void 0,void 0,function(){var t,n,a,i,r,o=this;return C(this,function(s){switch(s.label){case 0:return[4,this.graphService.getUserPhoto(e.id)];case 1:return t=s.sent(),e.directReports?[4,Promise.all(e.directReports.map(function(e){return o.transformGraphUserToOrgNodeAsync(e)}))]:[3,3];case 2:return a=s.sent(),[3,4];case 3:a=[],s.label=4;case 4:return i=(n=a).length,r=this.calculateReportingCount(n),[2,{id:e.id,name:e.displayName,title:e.jobTitle||"No Title",department:e.department||"No Department",photoUrl:t,children:n.length>0?n:void 0,directCount:i,reportingCount:r}]}})})},r.prototype.loadNodeChildren=function(e){return x(this,void 0,void 0,function(){var t,n,a=this;return C(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.graphService.getDirectReports(e)];case 1:return t=i.sent(),[4,Promise.all(t.map(function(e){return x(a,void 0,void 0,function(){var t,n,a,i,r;return C(this,function(o){switch(o.label){case 0:return[4,Promise.all([this.graphService.getUserPhoto(e.id),this.graphService.getDirectReports(e.id),this.graphService.getTotalSubordinatesCount(e.id)])];case 1:return t=o.sent(),n=t[0],a=t[1],i=t[2],r=a.length,[2,{id:e.id,name:e.displayName,title:e.jobTitle||"No Title",department:e.department||"No Department",photoUrl:n,directCount:r,reportingCount:i,children:void 0}]}})})}))];case 2:return[2,i.sent()];case 3:return n=i.sent(),console.error("Error loading children for node ".concat(e,":"),n),[2,[]];case 4:return[2]}})})},r.prototype.transformGraphUserToOrgNode=function(e){var t=this,n=e.directReports?e.directReports.map(function(e){return t.transformGraphUserToOrgNode(e)}):[],a=n.length,i=this.calculateReportingCount(n);return{id:e.id,name:e.displayName,title:e.jobTitle||"No Title",department:e.department||"No Department",children:n.length>0?n:void 0,directCount:a,reportingCount:i}},r.prototype.calculateReportingCount=function(e){if(!e||0===e.length)return 0;for(var t=e.length,n=0,a=e;n<a.length;n++){var i=a[n];i.children&&(t+=this.calculateReportingCount(i.children))}return t},r.prototype.onThemeChanged=function(e){if(e){var t=e.semanticColors;t&&(this.domElement.style.setProperty("--bodyText",t.bodyText||null),this.domElement.style.setProperty("--link",t.link||null),this.domElement.style.setProperty("--linkHovered",t.linkHovered||null))}},r.prototype.onPropertyPaneFieldChanged=function(e,t,n){"tabs"===e&&JSON.stringify(t)!==JSON.stringify(n)&&(this.orgData=null,this.render(),x(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return this.graphReadyPromise?[4,this.graphReadyPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,this.loadOrgData()];case 3:return e.sent(),[2]}})}).catch(function(e){console.error("Error reloading data after property change:",e)}))},Object.defineProperty(r.prototype,"dataVersion",{get:function(){return e.Version.parse("1.0")},enumerable:!1,configurable:!0}),r.prototype.getPropertyPaneConfiguration=function(){var e,n=this;return{pages:[{header:{description:i.PropertyPaneDescription},groups:[{groupName:"Tabs Configuration",groupFields:[(e={tabs:this.properties.tabs||[],onTabsChange:function(e){n.properties.tabs=e,n.context.propertyPane.refresh()}},new v("tabs",e))]},{groupName:i.BasicGroupName,groupFields:[(0,t.PropertyPaneTextField)("description",{label:i.DescriptionFieldLabel})]}]}]}},r}(n.BaseClientSideWebPart)})(),s})());